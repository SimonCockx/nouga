\begin{defbox}
\paragraph{Semantic algebra.}
\begin{align*}
A^0 &= Unit = \set{()} \\
A^n &= A \times A^{n-1} \\
A^{m:n} &= \bigcup_{k \in m..n} A^k \\
A^{*} &= A^{0:\infty}
\end{align*}

Note: from the above definition, $A^1$ formally equals $A \times Unit$, so elements of this set are of the form $(a, ())$ where $a \in A$. I might sometimes write $a$ instead of $(a, ())$ if it is clear from the context what is meant. (similar for $A^n$, where I will leave out the last element of the cartesian product)

\begin{align*}
\sor{\_}{\_} &: \sboolean^1 \times \sboolean^1 \to \sboolean^1 : \sor{(a, ())}{(b, ())} = (a \lor b, ()) \\
\sand{\_}{\_} &: \sboolean^1 \times \sboolean^1 \to \sboolean^1 : \sand{(a, ())}{(b, ())} = (a \land b, ()) \\
\snot{\_} &: \sboolean^1 \to \sboolean^1 : \snot{(a, ())} = (\lnot a, ()) \\
\schoice{\_}{\_}{\_} &: \sboolean^1 \times \sdom \times \sdom \to \sdom : \schoice{(a, ())}{b}{c} =
\begin{cases}
b, & a = true\\
c, & a = false
\end{cases} \\
\scount{\_} &: \sdom \to \sint^1 : \scount{(a_1, \dots, a_n, ())} = (n, ()) \\
\sflatten{A}{n}{\_} &: \left(A^{*}\right)^n \to A^{*} : \\
&\sflatten{A}{n}{(a_{11}, \dots, a_{1m_1}, ()), \dots, (a_{n1}, \dots, a_{nm_n}, ())} \\
&= (a_{11}, \dots, a_{1m_1}, \dots, a_{nm_n}, ()) \\
\scontains{\_}{\_} &: \sdom \times \sdom \to \sboolean^1 : \scontains{(a_1, \dots, a_n, ())}{(b_1, \dots, b_m, ())} \\
&= \begin{cases}
(true, ()), & \forall i \in 1..n : \exists j \in 1..m : b_i = a_j\\
(false, ()), & \text{otherwise}
\end{cases} \\
\sdisjoint{\_}{\_} &: \sdom \times \sdom \to \sboolean^1 : \sdisjoint{(a_1, \dots, a_n, ())}{(b_1, \dots, b_m, ())} \\
&= \begin{cases}
(true, ()), & \forall i \in 1..n : \forall j \in 1..m : a_i \neq b_j\\
(false, ()), & \text{otherwise}
\end{cases} \\
\sonlyexists{\set{a_k=A_k \mid k\in 1..n}}{a_i}{\_} &: \set{a_k=A_k \mid k\in 1..n}^1 \to \sboolean^1 : \\ &\sonlyexists{\set{a_k=A_k \mid k\in 1..n}}{a_i}{(\set{a_k=v_k \mid k\in 1..n}, ())} \\
&= \begin{cases}
(true, ()), & v_i \neq () \land \forall j \in 1..n : j \neq i \Rightarrow v_j = () \\
(false, ()), & \text{otherwise}
\end{cases} \\
\sproject{\set{a_k=A_k^{l_k:u_k} \mid k\in 1..n}}{a_i}{\_} &: \set{a_k=A_k^{l_k:u_k} \mid k\in 1..n}^{*} \to A_i^{*} : \\ \omit\rlap{$\displaystyle \qquad \sproject{\set{a_k=A_k^{l_k:u_k} \mid k\in 1..n}}{a_i}{(\set{a_k=v_{k1} \mid k\in 1..n}, \dots, \set{a_k=v_{km} \mid k\in 1..n}, ())}$} \\
&= \sflatten{A_i}{m}{v_{i1}, \dots, v_{im}} \\
\seq{\_}{\_} &: \sdom \times \sdom \to \sboolean^1 : \seq{(a_1, \dots, a_n, ())}{(b_1, \dots, b_m, ())} \\
&= \begin{cases}
(true, ()), & n = m \land \forall i \in 1..n : a_i = b_i \\
(false, ()), & \text{otherwise}
\end{cases} \\
\sneq{\_}{\_} &: \sdom \times \sdom \to \sboolean^1 : \sneq{(a_1, \dots, a_n, ())}{(b_1, \dots, b_m, ())} \\
&= \begin{cases}
(true, ()), & n \neq m \lor \forall i \in 1..n : a_i \neq b_i \\
(false, ()), & \text{otherwise}
\end{cases} \\
\salleq{\_}{\_} &: \sdom \times \ssingledom^1 \to \sboolean^1 : \salleq{(a_1, \dots, a_n, ())}{(b, ())} \\
&= \begin{cases}
(true, ()), & \forall i \in 1..n : a_i = b \\
(false, ()), & \text{otherwise}
\end{cases} \\
\sallneq{\_}{\_} &: \sdom \times \ssingledom^1 \to \sboolean^1 : \sallneq{(a_1, \dots, a_n, ())}{(b, ())} \\
&= \begin{cases}
(true, ()), & \forall i \in 1..n : a_i \neq b \\
(false, ()), & \text{otherwise}
\end{cases} \\
\sanyeq{\_}{\_} &: \sdom \times \ssingledom^1 \to \sboolean^1 : \sanyeq{(a_1, \dots, a_n, ())}{(b, ())} \\
&= \begin{cases}
(true, ()), & \exists i \in 1..n : a_i = b \\
(false, ()), & \text{otherwise}
\end{cases} \\
\sanyneq{\_}{\_} &: \sdom \times \ssingledom^1 \to \sboolean^1 : \sanyneq{(a_1, \dots, a_n, ())}{(b, ())} \\
&= \begin{cases}
(true, ()), & \exists i \in 1..n : a_i \neq b \\
(false, ()), & \text{otherwise}
\end{cases} \\
\splus{A}{\_}{\_} &: A^1 \times A^1 \to A^1 : \splus{A}{(a, ())}{(b, ())} = (a + b, ()) \\
\ssubt{A}{\_}{\_} &: A^1 \times A^1 \to A^1 : \ssubt{A}{(a, ())}{(b, ())} = (a - b, ()) \\
\smult{A}{\_}{\_} &: A^1 \times A^1 \to A^1 : \smult{A}{(a, ())}{(b, ())} = (a * b, ()) \\
\sdiv{\_}{\_} &: \snumber^1 \times \snumber^1 \to \snumber^1 : \sdiv{(a, ())}{(b, ())} = (a / b, ()) \\
\sonlyelement{\_} &: \sdom \to \sdom : \sonlyelement{(a_1, \dots, a_n, ())} \\
&= \begin{cases}
(a_1, ()), & n = 1 \\
(), & \text{otherwise}
\end{cases}
\end{align*}

Note: equality is checked deeply, i.e. recursively on attributes of records.


Given $f : A_1 \times \dots \times A_n \to B$ where $A_1, \dots, A_n \subset \sdom$ and $B \subset \sdom$, let
\begin{equation*}
\hat{f} : \sdom_\bot^n \to \sdom_\bot : \hat{f}(a_1, \dots, a_n) =
\begin{cases}
f(a_1, \dots, a_n), & (a_1, \dots, a_n) \in \dom{f} \\
\bot, & \text{otherwise.}
\end{cases}
\end{equation*}
\end{defbox}
